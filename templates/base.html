{% load static i18n share_image raven %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>GeoPuzzle - {% trans 'Mercator puzzle of ' %}{% block title %}{% trans 'World' %}{% endblock %}</title>
    <meta name="description" content="{% trans 'Arrange the pieces of the world!' %}"/>
    <meta name="keywords" content="geopuzzle, геопаззл, mercator puzzle, паззл меркатора"/>
    <meta name="viewport" content="initial-scale=1, user-scalable=no, width=device-width"/>
    <meta charset="utf-8">
    <meta name="application-name" content="GeoPuzzle">
    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}" />

    {% share_image request game %}
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'css/base.css' %}">
    {% block head_js %}
        <script>
          __LANGUAGE__ = '{{ request.LANGUAGE_CODE }}';
        </script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    {% endblock %}
    {% block extra_css %}
    {% endblock %}
</head>

<body>
    <div class="navbar-container">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">GeoPuzzle</a>
                    </div>
                    <div class="collapse navbar-collapse" id="main-navbar">
                        <ul class="nav navbar-nav">
                            <li><a href="{% url 'workshop' %}">{% trans 'Workshop' %}</a></li>
                        </ul>
                        <ul class="nav navbar-nav navbar-right">
                            <li class="donate-button"><iframe src="https://money.yandex.ru/quickpay/button-widget?targets=GeoPuzzle&default-sum=100&button-text=11&any-card-payment-type=on&button-size=m&button-color=orange&successURL=&quickpay=small&account=410012053429083&" width="184" height="36" frameborder="0" allowtransparency="true" scrolling="no"></iframe></li>
                            <li class="donate-button"><a href="https://www.paypal.me/tyvik" target="_blank" style="padding: 0"><img style="vertical-align: baseline" height="36px" src="https://i1.wp.com/www.lotus-happiness.com/wp-content/uploads/2015/11/Paypal-Donate-300x136.png?fit=300%2C136&ssl=1" alt="donate"></a></li>
{#                            <li class="donate-button"><a href="https://www.patreon.com/bePatron?u=11576139" data-patreon-widget-type="become-patron-button">Become a Patron!</a></li>#}
                            <li class="donate-button"><iframe src="https://www.patreon.com/platform/iframe?widget=become-patron-button&amp;redirectURI=http%3A%2F%2F127.0.0.1%3A8002%2Fpuzzle%2Fworkshop%2F&amp;creatorID=11576139" scrolling="no" allowtransparency="true" frameborder="0" class="patreon-widget" title="Patreon Widget" style="position: static; visibility: visible; height: 35px;"></iframe></li>

                            {% if request.user.is_authenticated %}
                                <li><a class="navbar-right navbar-link" href="{% url "profile" %}">@{{ request.user.username }}</a></li>
                                <li><a href="{% url 'logout' %}">({% trans 'logout' %})</a></li>
                            {% else %}
                                <li><a class="navbar-right navbar-link" href="{% url "login" %}">{% trans "Sign In" %}</a></li>
                                <li><a class="navbar-right navbar-link" href="{% url "registration" %}">{% trans "Sign Up" %}</a></li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </div>
{% block content %}
{% endblock %}

{% block extra_js %}
{% endblock %}

<script>
    window.fbAsyncInit = function () {
        FB.init({
            appId: '1273749826026102',
            xfbml: true,
            version: 'v2.9'
        });
        FB.AppEvents.logPageView();
    };

    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {
            return;
        }
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>
<script defer src="https://c6.patreon.com/becomePatronButton.bundle.js"></script>
<script src="https://browser.sentry-cdn.com/4.3.4/bundle.min.js" crossorigin="anonymous"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.js"></script>
<script>
  window.addEventListener("DOMContentLoaded", function(){
    Sentry.init({
      dsn: '{% sentry_public_dsn 'https' %}',
      release: '{{ settings.RAVEN_CONFIG.release }}',
      attachStacktrace: true,
      ignoreErrors: [
        'Cannot read property \'zoom\' of null',
        'null is not an object (evaluating \'e.zoom\')',
        'null is not an object (evaluating \'g.lineJoin="round"\')',
      ],
    });
  });
</script>

{% if not debug %}
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function () {
                try {
                    w.yaCounter42253364 = new Ya.Metrika({
                        id: 42253364,
                        clickmap: true,
                        trackLinks: true,
                        accurateTrackBounce: true,
                        webvisor: true
                    });
                } catch (e) {
                }
            });

            var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () {
                    n.parentNode.insertBefore(s, n);
                };
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://mc.yandex.ru/metrika/watch.js";

            if (w.opera == "[object Opera]") {
                d.addEventListener("DOMContentLoaded", f, false);
            } else {
                f();
            }
        })(document, window, "yandex_metrika_callbacks");
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-93687529-1', 'auto');
      ga('send', 'pageview');

    </script>
    <noscript>
        <div><img src="https://mc.yandex.ru/watch/42253364" style="position:absolute; left:-9999px;" alt=""/></div>
    </noscript>
    <!-- /Yandex.Metrika counter -->
{% endif %}
</body>
</html>
